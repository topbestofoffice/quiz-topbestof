(function(){"use strict";const config=window.AdSystemConfig||{};window.GAMManagerConfig={networkCode:config.networkCode||"22760191030",publisherName:config.publisherName||"Chandra Prakash Verma",domain:config.domain||"Chandra Prakash Verma",currency:config.currency||"USD",debug:config.debug||false,enableBotProtection:config.enableBotProtection!==undefined?config.enableBotProtection:true,botDetectionRegex:config.botDetectionRegex||/bot|googlebot|crawler|spider|robot|crawling|facebookexternalhit|lighthouse/i,allowCrawlers:config.allowCrawlers!==undefined?config.allowCrawlers:false,requireUserInteraction:config.requireUserInteraction!==undefined?config.requireUserInteraction:true,enableHeaderBidding:config.enableHeaderBidding!==undefined?config.enableHeaderBidding:false,headerBidding:config.headerBidding||{timeout:2500,maxPrice:2e3,priceStep:1,decimals:2,enablePrebid:false,bidders:[],floors:{enabled:false,method:"uprkvp",source:"disabled"}},enableLazyLoading:config.enableLazyLoading!==undefined?config.enableLazyLoading:true,lazyLoading:config.lazyLoading||{enabled:true,depth:1.75,fetchMargin:"200px",renderMargin:75,mobileScaling:2,viewabilityThreshold:.75},enableRebid:config.enableRebid!==undefined?config.enableRebid:true,rebidSystem:config.rebidSystem||{enabled:true,rounds:2,multiplier:.7,percent:1,timeout:1e3,maxAttempts:3},enableVignette:config.enableVignette!==undefined?config.enableVignette:true,vignetteAds:config.vignetteAds||{enabled:true,chance:.3,delay:1e4,cooldown:3e5,desktopEnabled:true,mobileEnabled:true,closeTimeout:"1/24",requireInteraction:true},enableOfferwall:config.enableOfferwall!==undefined?config.enableOfferwall:true,offerwallSystem:config.offerwallSystem||{enabled:true,durationThreshold:30,pageviewThreshold:3,showOnExit:true,rewardMultiplier:1.5,cooldownHours:24},enableRewardedAds:config.enableRewardedAds!==undefined?config.enableRewardedAds:true,rewardedAds:config.rewardedAds||{enabled:true,rewardAmount:100,currency:"coins",bonusMultiplier:1.2,maxDailyRewards:10,videoTimeout:3e4,skipDelay:5e3,autoRedirect:true,redirectDelay:2e3},enableTrafficCop:config.enableTrafficCop!==undefined?config.enableTrafficCop:true,trafficCop:config.trafficCop||{enabled:true,botThreshold:75,clickBlocker:true,clickThreshold:3,interstitialClickThreshold:30,captchaService:"reCaptcha",captchaEnabled:false,ivtAction:"measure",timeoutAction:"measure",allowFirstImpression:false,paramAutomation:true},performance:config.performance||{enableSingleRequest:true,collapseEmptyDivs:true,timeout:2e3,refreshEnabled:false,refreshMax:0,refreshTimeout:90,refreshViewports:.75,scrollViewability:true,scrollViewabilityTimeout:1e3,unitMinHeight:true,unitAutoMargin:true,unitCenter:true,optimizeSizes:true},analytics:config.analytics||{enabled:true,endpoint:"https://a3.pubguru.net/",trackingEnabled:true,trackURI:true,trackUTMs:true,utmTracking:"utm_term, utm_source, utm_campaign, utm_content, utm_medium",utmPercent:.001,sessionTracking:true,performanceTracking:true,errorTracking:true,impressionTracking:true,clickTracking:true,viewabilityTracking:true},enableAnchorAds:config.enableAnchorAds!==undefined?config.enableAnchorAds:true,anchorAds:config.anchorAds||{enabled:true,position:"bottom",delay:0,device:"both",closeButton:true,closeTimeout:"1/24",percent:1},mobileOptimized:config.mobileOptimized!==undefined?config.mobileOptimized:true,mobileBreakpoint:config.mobileBreakpoint||768,callbacks:config.callbacks||{onAdLoaded:function(slotName,size){console.log(`üìà [GAM] Ad loaded: ${slotName} (${size[0]}x${size[1]})`)},onAdEmpty:function(slotName){console.log(`üì≠ [GAM] Ad empty: ${slotName}`)},onRewardFailed:function(reason,canRetry){console.log(`‚ùå [GAM] Reward failed: ${reason} (retry: ${canRetry})`)},onRewardGranted:function(amount,event){console.log(`üéâ [GAM] Reward granted: ${amount}`)}},timeout:config.performance?.timeout||2e3,refreshTimeout:config.performance?.refreshTimeout||90,enableSingleRequest:config.performance?.enableSingleRequest!==undefined?config.performance.enableSingleRequest:true,collapseEmptyDivs:config.performance?.collapseEmptyDivs!==undefined?config.performance.collapseEmptyDivs:true,lazyLoadMargin:config.lazyLoading?.fetchMargin||"200px",lazyLoadThreshold:config.lazyLoading?.depth||1.75,anchorPosition:config.anchorAds?.position||"bottom",anchorDelay:config.anchorAds?.delay||0,rewardAmount:config.rewardedAds?.rewardAmount||100,rewardCurrency:config.rewardedAds?.currency||"coins",retryTimeGapInMS:config.rebidSystem?.timeout||2e3,maxRetry:config.rebidSystem?.maxAttempts||3,adUnits:config.adUnits||[{slotName:"Topbestof_Desk_Leaderboard",adUnitPath:"/22760191030/j4512323",device:"desktop",sizes:[[728,90],[728,250],[970,90],[750,300],[970,250]],position:"header",isLazy:false,targeting:{},customCss:""},{slotName:"Topbestof_Desk_Incontent_Lazy",adUnitPath:"/22760191030/Topbestof_Desk_Incontent_Lazy",device:"desktop",sizes:[[728,90],[728,250],[300,250],[336,280],[640,360]],position:"content",isLazy:true,targeting:{},customCss:""},{slotName:"Topbestof_Desktop_Sidebar_ATF",adUnitPath:"/22760191030/Topbestof_Desktop_Sidebar_ATF",device:"desktop",sizes:[[160,600],[300,250],[120,600]],position:"sidebar",isLazy:false,targeting:{},customCss:""},{slotName:"Topbestof_Desktop_Sidebar_BTF",adUnitPath:"/22760191030/Topbestof_Desktop_Sidebar_BTF",device:"desktop",sizes:[[300,250],[160,600],[120,600]],position:"sidebar",isLazy:true,targeting:{},customCss:""},{slotName:"Topbestof_Mobile_Leaderboard",adUnitPath:"/22760191030/j4512323",device:"mobile",sizes:[[300,250],[250,250],[336,280],[320,480]],position:"header",isLazy:false,targeting:{},customCss:""},{slotName:"Topbestof_Mobile_Mob_Incontent_Lazy",adUnitPath:"/22760191030/Topbestof_Mobile_Mob_Incontent_Lazy",device:"mobile",sizes:[[300,250],[336,280],[320,100],[320,480],[336,480],[250,250],[336,336],[300,600]],position:"content",isLazy:true,targeting:{},customCss:""},{slotName:"Topbestof_Mobile_Top",adUnitPath:"/22760191030/j4578325",device:"mobile",sizes:[[250,250],[300,250],[336,280],[336,336]],position:"header",isLazy:false,targeting:{},customCss:""}]};class GAMManager{constructor(config){this.config=config;this.slots=new Map;this.lazySlots=new Map;this.observer=null;this.anchorSlots=[];this.isInitialized=false;this.isMobile=window.innerWidth<=config.mobileBreakpoint;this.startTime=performance.now();this.retryAttempts=new Map;this.init()}init(){if(this.isInitialized)return;this.log("Starting GAM initialization with all 10 major features...");if(this.config.enableBotProtection&&this.detectBot()){this.log("Bot detected - stopping initialization");if(this.config.callbacks.onBotDetected){this.config.callbacks.onBotDetected.call(this.config,"initialization_block",navigator.userAgent)}return}if(this.config.enableHeaderBidding){this.initializeHeaderBidding()}else{this.log("Header bidding disabled - using direct GAM only")}if(this.config.enableLazyLoading){this.initializeLazyLoading()}if(!this.config.enableRebid){console.log(`üö´ [REBID DEBUG] Rebid system disabled in configuration`)}if(this.config.enableVignette){this.initializeVignette()}if(this.config.enableOfferwall){this.initializeOfferwall()}else{console.log(`üö´ [OFFERWALL DEBUG] Offerwall system disabled in configuration`)}if(this.config.enableRewardedAds){this.initializeRewardedAds()}if(this.config.enableTrafficCop){this.initializeAdvancedBotProtection()}this.initializePerformanceOptimization();if(this.config.analytics.enabled){this.initializeAnalytics()}this.initializeGAM();if(this.config.enableAnchorAds){this.initializeAnchorAds()}this.isInitialized=true;this.log("GAM Manager initialized successfully with all features");if(this.config.analytics.enabled&&this.config.callbacks.trackEvent){this.config.callbacks.trackEvent.call(this.config,"gam_initialized",{features:{botProtection:this.config.enableBotProtection,headerBidding:this.config.enableHeaderBidding,lazyLoading:this.config.enableLazyLoading,rebid:this.config.enableRebid,vignette:this.config.enableVignette,offerwall:this.config.enableOfferwall,rewarded:this.config.enableRewardedAds,trafficCop:this.config.enableTrafficCop,analytics:this.config.analytics.enabled},timestamp:Date.now(),loadTime:performance.now()-this.startTime})}}initializeGAM(){window.googletag=window.googletag||{};window.googletag.cmd=window.googletag.cmd||[];const self=this;googletag.cmd.push(function(){if(self.config.enableSingleRequest){googletag.pubads().enableSingleRequest()}if(self.config.collapseEmptyDivs){googletag.pubads().collapseEmptyDivs()}googletag.pubads().setTargeting("domain",self.config.domain);googletag.pubads().setTargeting("device",self.isMobile?"mobile":"desktop");googletag.pubads().addEventListener("slotRenderEnded",function(event){self.handleSlotRenderEnded(event)});googletag.pubads().addEventListener("slotOnload",function(event){self.handleSlotOnload(event)});googletag.pubads().addEventListener("impressionViewable",function(event){self.handleImpressionViewable(event)});try{googletag.pubads().addEventListener("rewardedSlotReady",function(event){console.log("üéØ [GAM] Rewarded slot ready:",event);const adUnitPath=event.slot.getAdUnitPath();console.log("üîç [GAM] Rewarded slot path:",adUnitPath);if(adUnitPath.includes("Topbestof_Rewarded")||adUnitPath.includes("Rewarded")){console.log("‚úÖ [GAM] Rewarded ad slot is ready to be shown");self.setupRewardedSlotListener(event.slot)}});const originalSlotRenderEnded=self.handleSlotRenderEnded.bind(self);self.handleSlotRenderEnded=function(event){const adUnitPath=event.slot.getAdUnitPath();if(adUnitPath.includes("Topbestof_Rewarded")||adUnitPath.includes("Rewarded")){console.log("üéÅ [GAM] Rewarded ad slot rendered:",event);if(!event.isEmpty){console.log("‚úÖ [GAM] Rewarded ad loaded and ready")}else{console.log("‚ùå [GAM] Rewarded ad slot is empty");if(self.config.callbacks.onRewardFailed){self.config.callbacks.onRewardFailed.call(self.config,"No ad available",true)}}}return originalSlotRenderEnded(event)};googletag.pubads().addEventListener("rewardedSlotGranted",function(event){console.log("üéÅ [GAM] Rewarded slot granted:",event);if(self.handleRewardedAdGranted){self.handleRewardedAdGranted(event)}});googletag.pubads().addEventListener("rewardedSlotClosed",function(event){console.log("üö™ [GAM] Rewarded slot closed:",event);if(self.handleRewardedAdClosed){self.handleRewardedAdClosed(event)}});console.log("‚úÖ [GAM] Rewarded ad detection setup complete")}catch(error){console.warn("‚ö†Ô∏è [GAM] Error setting up rewarded ad detection:",error)}googletag.enableServices();console.log(`‚úÖ [GAM DEBUG] GAM services enabled successfully`);if(self.config.enableRebid){console.log(`üîÑ [GAM DEBUG] Initializing rebid system after GAM is ready...`);self.initializeRebid()}else{console.log(`üö´ [GAM DEBUG] Rebid system disabled - skipping initialization`)}self.log("GAM services enabled")})}initializeLazyLoading(){if(!("IntersectionObserver"in window)){this.log("IntersectionObserver not supported - loading all ads immediately");this.loadAllAds();return}const options={rootMargin:this.config.lazyLoadMargin,threshold:.01};this.observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){const element=entry.target;const slotName=element.getAttribute("data-slot-name");if(slotName&&this.lazySlots.has(slotName)){this.loadLazyAd(slotName);this.observer.unobserve(element)}}})},options);this.log("Lazy loading initialized")}initializeRewardedAds(){console.log(`üéÅ [REWARD DEBUG] Initializing rewarded ads system:`,{enabled:this.config.rewardedAds.enabled,rewardAmount:this.config.rewardedAds.rewardAmount,currency:this.config.rewardedAds.currency,maxDailyRewards:this.config.rewardedAds.maxDailyRewards,videoTimeout:this.config.rewardedAds.videoTimeout,skipDelay:this.config.rewardedAds.skipDelay,autoRedirect:this.config.rewardedAds.autoRedirect,bonusMultiplier:this.config.rewardedAds.bonusMultiplier});this.initializeDailyRewards();window.RewardAd=()=>{console.log(`üéØ [REWARD DEBUG] RewardAd() called from global scope`);return this.showRewardedAd("global_RewardAd")};window.TopbestofReward=()=>{console.log(`üéØ [REWARD DEBUG] TopbestofReward() called from global scope`);return this.showRewardedAd("global_TopbestofReward")};window.sessionStartTime=Date.now();console.log(`‚úÖ [REWARD DEBUG] Rewarded ads system initialized successfully`);this.log("Rewarded ads initialized")}initializeDailyRewards(){const today=(new Date).toDateString();const dailyRewards=JSON.parse(localStorage.getItem("dailyRewards")||"{}");const sevenDaysAgo=new Date(Date.now()-7*24*60*60*1e3).toDateString();Object.keys(dailyRewards).forEach(date=>{if(new Date(date)<new Date(sevenDaysAgo)){delete dailyRewards[date]}});localStorage.setItem("dailyRewards",JSON.stringify(dailyRewards));const todayCount=dailyRewards[today]||0;console.log(`üìä [REWARD DEBUG] Daily rewards status:`,{today:today,todayCount:todayCount,maxDaily:this.config.rewardedAds.maxDailyRewards,remaining:Math.max(0,this.config.rewardedAds.maxDailyRewards-todayCount),canEarnMore:todayCount<this.config.rewardedAds.maxDailyRewards})}initializeAnchorAds(){if(this.config.anchorDelay>0){setTimeout(()=>this.showAnchorAds(),this.config.anchorDelay)}else{if(document.readyState==="complete"){this.showAnchorAds()}else{window.addEventListener("load",()=>this.showAnchorAds())}}}initializeHeaderBidding(){if(!this.config.enableHeaderBidding)return;this.log("Initializing header bidding...");if(this.config.headerBidding.enablePrebid&&window.pbjs){window.pbjs.que=window.pbjs.que||[];window.pbjs.que.push(()=>{window.pbjs.setConfig({currency:{adServerCurrency:this.config.currency,granularityMultiplier:this.config.headerBidding.priceStep},priceGranularity:{buckets:[{precision:this.config.headerBidding.decimals,min:0,max:this.config.headerBidding.maxPrice,increment:this.config.headerBidding.priceStep}]},bidderTimeout:this.config.headerBidding.timeout});if(this.config.headerBidding.bidders.length>0){window.pbjs.addAdUnits(this.createPrebidAdUnits())}});this.log("Prebid.js configuration completed")}this.headerBiddingTimeout=this.config.headerBidding.timeout;this.log("Header bidding initialized")}initializePerformanceOptimization(){this.log("Initializing performance optimizations...");this.performanceMetrics={startTime:performance.now(),adLoadTimes:new Map,viewabilityData:new Map,errorCount:0,impressionCount:0,clickCount:0};if(this.config.performance.refreshEnabled){this.initializeAdRefresh()}if(this.config.performance.scrollViewability){this.initializeScrollViewability()}this.preconnectGAM();this.log("Performance optimizations initialized")}initializeAdRefresh(){this.refreshCounts=new Map;this.lastRefreshTimes=new Map;setInterval(()=>{this.checkAdRefreshEligibility()},this.config.performance.refreshTimeout*1e3);this.log("Ad refresh system initialized")}initializeScrollViewability(){let viewabilityTimer;const checkViewability=()=>{clearTimeout(viewabilityTimer);viewabilityTimer=setTimeout(()=>{if(typeof this.trackPerformanceMetric==="function"){this.trackPerformanceMetric("scroll_viewability",Date.now())}else{console.log("[GAM] Scroll viewability tracked:",Date.now())}},this.config.performance.scrollViewabilityTimeout)};window.addEventListener("scroll",checkViewability,{passive:true});window.addEventListener("resize",checkViewability,{passive:true});this.log("Scroll viewability tracking initialized")}preconnectGAM(){try{const link=document.createElement("link");link.rel="preconnect";link.href="https://securepubads.g.doubleclick.net";link.crossOrigin="anonymous";document.head.appendChild(link);const dnsLink=document.createElement("link");dnsLink.rel="dns-prefetch";dnsLink.href="https://securepubads.g.doubleclick.net";document.head.appendChild(dnsLink);this.log("GAM preconnect enabled")}catch(error){this.log("Failed to preconnect to GAM: "+error.message)}}initializeAnalytics(){this.log("Initializing analytics and monitoring...");if(this.config.analytics.sessionTracking){this.sessionId=this.generateSessionId();this.sessionStartTime=Date.now();this.pageViews=parseInt(sessionStorage.getItem("adsystem_pageviews")||"0")+1;sessionStorage.setItem("adsystem_pageviews",this.pageViews.toString())}if(this.config.analytics.errorTracking){window.addEventListener("error",event=>{this.trackError(event.error,"global_error",true)});window.addEventListener("unhandledrejection",event=>{this.trackError(event.reason,"unhandled_promise",true)})}if(this.config.analytics.performanceTracking){this.trackCoreWebVitals()}if(this.config.analytics.trackUTMs){this.trackUTMParameters()}if(this.config.analytics.endpoint){this.preconnectAnalytics()}this.log("Analytics and monitoring initialized")}generateSessionId(){return"adsystem_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}trackCoreWebVitals(){if("PerformanceObserver"in window){const observer=new PerformanceObserver(list=>{for(const entry of list.getEntries()){if(entry.entryType==="largest-contentful-paint"){this.trackPerformanceMetric("lcp",entry.startTime)}if(entry.entryType==="first-input"){this.trackPerformanceMetric("fid",entry.processingStart-entry.startTime)}}});observer.observe({entryTypes:["largest-contentful-paint","first-input"]})}}trackUTMParameters(){const urlParams=new URLSearchParams(window.location.search);const utmParams={};["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach(param=>{if(urlParams.has(param)){utmParams[param]=urlParams.get(param)}});if(Object.keys(utmParams).length>0){this.utmData=utmParams;if(this.config.callbacks.trackEvent){this.config.callbacks.trackEvent.call(this.config,"utm_tracked",utmParams)}}}preconnectAnalytics(){try{const link=document.createElement("link");link.rel="preconnect";link.href=this.config.analytics.endpoint;document.head.appendChild(link)}catch(error){this.log("Failed to preconnect to analytics: "+error.message)}}initializeRebid(){console.log(`üîÑ [REBID DEBUG] Initializing rebid system...`);if(!this.config.enableRebid){console.log(`üö´ [REBID DEBUG] Rebid system disabled in config`);return}if(typeof googletag==="undefined"){console.error(`‚ùå [REBID DEBUG] googletag not available - deferring rebid initialization`);setTimeout(()=>{if(typeof googletag!=="undefined"){this.initializeRebid()}else{console.error(`‚ùå [REBID DEBUG] googletag still not available after retry`)}},1e3);return}console.log(`üîÑ [REBID DEBUG] googletag available, setting up rebid system:`,{enabled:this.config.rebidSystem.enabled,rounds:this.config.rebidSystem.rounds,multiplier:this.config.rebidSystem.multiplier,maxAttempts:this.config.rebidSystem.maxAttempts,timeout:this.config.rebidSystem.timeout});this.rebidAttempts=new Map;const self=this;googletag.cmd.push(()=>{try{console.log(`üîÑ [REBID DEBUG] Adding slotRenderEnded event listener`);googletag.pubads().addEventListener("slotRenderEnded",function(event){console.log(`üì∫ [REBID DEBUG] Slot render ended:`,{slotName:event.slot.getSlotElementId(),isEmpty:event.isEmpty,size:event.size,advertiserId:event.advertiserId,campaignId:event.campaignId});if(event.isEmpty){console.log(`üîÑ [REBID DEBUG] Empty slot detected - triggering rebid`);self.handleRebid(event.slot)}else{console.log(`‚úÖ [REBID DEBUG] Slot filled successfully - no rebid needed`)}});console.log(`‚úÖ [REBID DEBUG] Rebid system initialized successfully`)}catch(error){console.error(`‚ùå [REBID DEBUG] Error initializing rebid system:`,{error:error.message,stack:error.stack})}});this.log("Rebid system initialized")}handleRebid(slot){const slotName=this.getSlotNameFromSlot(slot);const attempts=this.rebidAttempts.get(slotName)||0;const maxAttempts=this.config.rebidSystem.maxAttempts||3;const timeout=this.config.rebidSystem.timeout||1e3;console.log(`üîÑ [REBID DEBUG] Handling rebid for slot:`,{slotName:slotName,currentAttempts:attempts,maxAttempts:maxAttempts,timeout:timeout+"ms",slotId:slot.getSlotElementId(),adUnitPath:slot.getAdUnitPath()});if(attempts<maxAttempts){this.rebidAttempts.set(slotName,attempts+1);console.log(`üîÑ [REBID DEBUG] Starting rebid attempt ${attempts+1}/${maxAttempts} for ${slotName}`);setTimeout(()=>{try{console.log(`üîÑ [REBID DEBUG] Executing rebid refresh for ${slotName}`);if(typeof googletag!=="undefined"&&googletag.pubads){googletag.cmd.push(()=>{googletag.pubads().refresh([slot]);console.log(`‚úÖ [REBID DEBUG] Rebid refresh executed for ${slotName}`)})}else{console.error(`‚ùå [REBID DEBUG] googletag not available for rebid refresh`)}}catch(error){console.error(`‚ùå [REBID DEBUG] Error during rebid refresh:`,{slotName:slotName,error:error.message,stack:error.stack})}},timeout);this.log(`Rebid attempt ${attempts+1} for ${slotName}`)}else{console.warn(`‚ö†Ô∏è [REBID DEBUG] Max rebid attempts reached for ${slotName} (${attempts}/${maxAttempts})`);if(this.config.callbacks.onAdFailed){this.config.callbacks.onAdFailed.call(this.config,slotName,"Max rebid attempts reached",attempts)}}}initializeVignette(){if(!this.config.enableVignette){console.log(`üö´ [VIGNETTE DEBUG] Vignette system disabled in config`);return}console.log(`üéØ [VIGNETTE DEBUG] Initializing vignette system:`,{enabled:this.config.vignetteAds.enabled,chance:this.config.vignetteAds.chance,delay:this.config.vignetteAds.delay,cooldown:this.config.vignetteAds.cooldown,desktopEnabled:this.config.vignetteAds.desktopEnabled,mobileEnabled:this.config.vignetteAds.mobileEnabled,requireInteraction:this.config.vignetteAds.requireInteraction,currentDevice:this.isMobile?"mobile":"desktop"});this.vignetteShown=false;this.vignetteLastShown=parseInt(localStorage.getItem("lastVignetteShown")||"0");this.interstitialSlot=null;this.userHasInteracted=false;if(this.config.vignetteAds.requireInteraction){console.log(`üëÜ [VIGNETTE DEBUG] Waiting for user interaction before showing vignette`);const interactionEvents=["click","touchstart","keydown","scroll"];const handleInteraction=()=>{this.userHasInteracted=true;window.userHasInteracted=true;console.log(`‚úÖ [VIGNETTE DEBUG] User interaction detected - vignette now eligible`);interactionEvents.forEach(event=>{document.removeEventListener(event,handleInteraction)})};interactionEvents.forEach(event=>{document.addEventListener(event,handleInteraction,{once:true,passive:true})})}else{this.userHasInteracted=true;window.userHasInteracted=true}this.log("Vignette system initialized - handled by PubGuru native system");if(this.config.vignetteAds.delay>0){console.log(`‚è∞ [VIGNETTE DEBUG] Scheduling vignette check in ${this.config.vignetteAds.delay}ms`);setTimeout(()=>{console.log(`‚è∞ [VIGNETTE DEBUG] Vignette delay complete - checking eligibility`);this.maybeShowVignette()},this.config.vignetteAds.delay)}else{console.log(`‚è∞ [VIGNETTE DEBUG] No delay configured - immediate eligibility check`);setTimeout(()=>this.maybeShowVignette(),1e3)}}maybeShowVignette(){console.log(`üéØ [VIGNETTE DEBUG] Checking vignette eligibility...`);if(!this.config.vignetteAds.enabled){console.log(`üö´ [VIGNETTE DEBUG] Vignette disabled in ads config`);if(this.config.callbacks.onVignetteEligibilityCheck){this.config.callbacks.onVignetteEligibilityCheck.call(this.config,false,"disabled_in_config",{})}return false}const now=Date.now();const timeSinceLastShown=now-this.vignetteLastShown;const cooldownPassed=timeSinceLastShown>=this.config.vignetteAds.cooldown;console.log(`‚è∞ [VIGNETTE DEBUG] Cooldown check:`,{lastShown:new Date(this.vignetteLastShown).toISOString(),timeSinceLastShown:timeSinceLastShown+"ms",cooldownRequired:this.config.vignetteAds.cooldown+"ms",cooldownPassed:cooldownPassed});if(!cooldownPassed){const remainingCooldown=this.config.vignetteAds.cooldown-timeSinceLastShown;console.log(`‚è∞ [VIGNETTE DEBUG] Cooldown active - ${Math.ceil(remainingCooldown/1e3)}s remaining`);if(this.config.callbacks.onVignetteEligibilityCheck){this.config.callbacks.onVignetteEligibilityCheck.call(this.config,false,"cooldown_active",{remainingMs:remainingCooldown})}return false}if(this.config.vignetteAds.requireInteraction&&!this.userHasInteracted){console.log(`üëÜ [VIGNETTE DEBUG] User interaction required but not detected`);if(this.config.callbacks.onVignetteEligibilityCheck){this.config.callbacks.onVignetteEligibilityCheck.call(this.config,false,"no_user_interaction",{})}return false}const randomValue=Math.random();const passedProbability=randomValue<=this.config.vignetteAds.chance;console.log(`üé≤ [VIGNETTE DEBUG] Probability check:`,{randomValue:randomValue.toFixed(4),requiredChance:this.config.vignetteAds.chance,passed:passedProbability});if(!passedProbability){if(this.config.callbacks.onVignetteEligibilityCheck){this.config.callbacks.onVignetteEligibilityCheck.call(this.config,false,"probability_failed",{randomValue:randomValue,requiredChance:this.config.vignetteAds.chance})}return false}console.log(`üì± [VIGNETTE DEBUG] Device check:`,{isMobile:this.isMobile,mobileEnabled:this.config.vignetteAds.mobileEnabled,desktopEnabled:this.config.vignetteAds.desktopEnabled});if(this.isMobile&&!this.config.vignetteAds.mobileEnabled){console.log(`üì± [VIGNETTE DEBUG] Vignette disabled for mobile devices`);if(this.config.callbacks.onVignetteEligibilityCheck){this.config.callbacks.onVignetteEligibilityCheck.call(this.config,false,"mobile_disabled",{})}return false}if(!this.isMobile&&!this.config.vignetteAds.desktopEnabled){console.log(`üíª [VIGNETTE DEBUG] Vignette disabled for desktop devices`);if(this.config.callbacks.onVignetteEligibilityCheck){this.config.callbacks.onVignetteEligibilityCheck.call(this.config,false,"desktop_disabled",{})}return false}console.log(`‚úÖ [VIGNETTE DEBUG] All eligibility checks passed - showing vignette`);if(this.config.callbacks.onVignetteEligibilityCheck){this.config.callbacks.onVignetteEligibilityCheck.call(this.config,true,"eligible",{cooldownPassed:cooldownPassed,probabilityPassed:passedProbability,deviceSupported:true,userInteracted:this.userHasInteracted})}return this.showVignette()}showVignette(){console.log(`üé¨ [VIGNETTE DEBUG] Attempting to show vignette ad...`);try{const showStartTime=performance.now();console.log(`üé¨ [VIGNETTE DEBUG] Vignette show initiated:`,{timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,viewport:`${window.innerWidth}x${window.innerHeight}`,screen:`${window.screen.width}x${window.screen.height}`,referrer:document.referrer,currentURL:window.location.href,isMobile:this.isMobile,connectionType:navigator.connection?navigator.connection.effectiveType:"unknown"});if(window.TopbestofAdX&&window.TopbestofAdX.showInterstitial){console.log("üéØ [VIGNETTE DEBUG] Using AdX native interstitial...");const adxResult=window.TopbestofAdX.showInterstitial();if(adxResult){this.recordVignetteSuccess(showStartTime);return true}}if(window.googletag&&googletag.pubads){console.log("üéØ [VIGNETTE DEBUG] Creating GAM interstitial slot...");googletag.cmd.push(()=>{try{const slotId=`interstitial_${Date.now()}`;const adUnitPath=`/${this.config.networkCode}/Topbestof_Interstitial`;const interstitialSlot=googletag.defineOutOfPageSlot(adUnitPath,googletag.enums.OutOfPageFormat.INTERSTITIAL);if(interstitialSlot){interstitialSlot.addService(googletag.pubads());interstitialSlot.setTargeting("ad_type","interstitial");interstitialSlot.setTargeting("device",this.isMobile?"mobile":"desktop");interstitialSlot.setTargeting("page",window.location.pathname.split("/").pop()||"index");googletag.pubads().addEventListener("slotRenderEnded",event=>{if(event.slot===interstitialSlot){console.log("üé¨ [VIGNETTE DEBUG] Interstitial slot rendered:",event);if(!event.isEmpty){this.recordVignetteSuccess(showStartTime)}else{console.warn("‚ö†Ô∏è [VIGNETTE DEBUG] Interstitial slot is empty")}}});googletag.display(interstitialSlot);console.log("‚úÖ [VIGNETTE DEBUG] GAM interstitial slot displayed");return true}else{console.error("‚ùå [VIGNETTE DEBUG] Failed to create interstitial slot")}}catch(gamError){console.error("‚ùå [VIGNETTE DEBUG] GAM interstitial error:",gamError)}})}if(window.adsbygoogle){console.log("üéØ [VIGNETTE DEBUG] Triggering AdSense auto interstitial...");this.recordVignetteSuccess(showStartTime);return true}console.warn("‚ö†Ô∏è [VIGNETTE DEBUG] No interstitial method available");return false}catch(error){console.error(`‚ùå [VIGNETTE DEBUG] Error showing vignette:`,{error:error.message,stack:error.stack,timestamp:(new Date).toISOString(),config:this.config.vignetteAds});if(this.config.callbacks.onVignetteError){this.config.callbacks.onVignetteError.call(this.config,error,"show_vignette")}this.log("Error in vignette trigger: "+error.message);return false}}recordVignetteSuccess(showStartTime){this.vignetteShown=true;this.vignetteLastShown=Date.now();localStorage.setItem("lastVignetteShown",this.vignetteLastShown.toString());const showEndTime=performance.now();const showDuration=showEndTime-showStartTime;console.log(`‚ö° [VIGNETTE DEBUG] Vignette show completed:`,{duration:showDuration.toFixed(2)+"ms",success:true,handledBy:"GAM/AdX system"});if(this.config.callbacks.onVignetteShown){try{this.config.callbacks.onVignetteShown("vignette_interstitial")}catch(callbackError){console.error(`‚ùå [VIGNETTE DEBUG] Callback error:`,callbackError)}}console.log(`‚è∞ [VIGNETTE DEBUG] Next vignette eligible in ${this.config.vignetteAds.cooldown/1e3}s`);this.log("Vignette interstitial displayed successfully")}initializeOfferwall(){if(!this.config.enableOfferwall)return;this.sessionStart=Date.now();this.pageviews=parseInt(sessionStorage.getItem("adsystem_pageviews")||"0")+1;sessionStorage.setItem("adsystem_pageviews",this.pageviews.toString());setTimeout(()=>{this.checkOfferwallEligibility()},this.config.offerwallDurationThreshold*1e3);this.log("Offerwall system initialized")}checkOfferwallEligibility(){const sessionDuration=(Date.now()-this.sessionStart)/1e3;if(sessionDuration>=this.config.offerwallDurationThreshold&&this.pageviews>=this.config.offerwallPageviewThreshold){this.showOfferwall()}}showOfferwall(){const modal=document.createElement("div");modal.style.cssText=`
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); z-index: 10001;
                display: flex; justify-content: center; align-items: center;
            `;modal.innerHTML=`
                <div style="background: white; padding: 30px; border-radius: 10px; text-align: center; max-width: 400px;">
                    <h2>üéÅ Earn More Coins!</h2>
                    <p>Complete offers and surveys to earn extra coins!</p>
                    <button onclick="this.closest('div[style*=\"fixed\"]').remove()" 
                            style="background: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 10px;">
                        View Offers
                    </button>
                    <button onclick="this.closest('div[style*=\"fixed\"]').remove()" 
                            style="background: #ccc; color: black; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 10px;">
                        Maybe Later
                    </button>
                </div>
            `;document.body.appendChild(modal);this.log("Offerwall shown")}loadAllAds(){const deviceAdUnits=this.config.adUnits.filter(unit=>unit.device===(this.isMobile?"mobile":"desktop"));deviceAdUnits.forEach(adUnit=>{if(adUnit.isLazy){this.setupLazyAd(adUnit)}else{this.loadAd(adUnit)}})}loadAd(adUnit){if(adUnit.isAnchor){this.anchorSlots.push(adUnit);return}const element=document.querySelector(`[data-slot-name="${adUnit.slotName}"]`);if(!element){this.log(`Element not found for slot: ${adUnit.slotName}`);return}const divId=adUnit.slotName;element.innerHTML=`<div id="${divId}"></div>`;const self=this;googletag.cmd.push(function(){const slot=googletag.defineSlot(adUnit.adUnitPath,adUnit.sizes,divId);if(slot){Object.keys(adUnit.targeting).forEach(key=>{slot.setTargeting(key,adUnit.targeting[key])});slot.addService(googletag.pubads());self.slots.set(adUnit.slotName,slot);googletag.display(divId);self.log(`Loaded ad: ${adUnit.slotName}`)}})}setupLazyAd(adUnit){const element=document.querySelector(`[data-slot-name="${adUnit.slotName}"]`);if(!element){this.log(`Element not found for lazy slot: ${adUnit.slotName}`);return}this.lazySlots.set(adUnit.slotName,adUnit);if(this.observer){this.observer.observe(element)}else{this.loadAd(adUnit)}}loadLazyAd(slotName){const adUnit=this.lazySlots.get(slotName);if(adUnit){this.loadAd(adUnit);this.lazySlots.delete(slotName);this.log(`Lazy loaded: ${slotName}`)}}showAnchorAds(){this.anchorSlots.forEach(adUnit=>{this.createAnchorAd(adUnit)})}createAnchorAd(adUnit){const anchorId=adUnit.slotName;const anchorDiv=document.createElement("div");anchorDiv.id=`anchor-${anchorId}`;anchorDiv.style.cssText=`
                position: fixed;
                ${this.config.anchorPosition}: 0;
                left: 0;
                right: 0;
                z-index: 9999;
                text-align: center;
                background: rgba(255,255,255,0.95);
                box-shadow: 0 0 10px rgba(0,0,0,0.3);
                ${adUnit.customCss}
            `;const closeBtn=document.createElement("button");closeBtn.innerHTML="√ó";closeBtn.style.cssText=`
                position: absolute;
                top: 5px;
                right: 10px;
                background: none;
                border: none;
                font-size: 18px;
                cursor: pointer;
                z-index: 10000;
            `;closeBtn.onclick=()=>anchorDiv.style.display="none";const adDiv=document.createElement("div");adDiv.id=anchorId;anchorDiv.appendChild(closeBtn);anchorDiv.appendChild(adDiv);document.body.appendChild(anchorDiv);const self=this;googletag.cmd.push(function(){const slot=googletag.defineSlot(adUnit.adUnitPath,adUnit.sizes,anchorId);if(slot){slot.addService(googletag.pubads());self.slots.set(adUnit.slotName,slot);googletag.display(anchorId);self.log(`Anchor ad created: ${adUnit.slotName}`)}})}isRewardedAdAvailable(){return this.rewardedSlot&&this.rewardedAdLoaded&&this.dailyRewards<this.config.rewardedAds.maxDailyRewards}getRemainingDailyRewards(){return Math.max(0,this.config.rewardedAds.maxDailyRewards-this.dailyRewards)}handleSlotRenderEnded(event){const slotName=this.getSlotNameFromEvent(event);if(event.isEmpty){if(this.config.callbacks&&this.config.callbacks.onAdEmpty){this.config.callbacks.onAdEmpty.call(this.config,slotName)}if(this.config.maxRetry>0){const attempts=this.retryAttempts?.get(slotName)||0;if(attempts<this.config.maxRetry){this.retryAttempts=this.retryAttempts||new Map;this.retryAttempts.set(slotName,attempts+1);this.retryFailedAd(slotName,attempts+1)}}if(this.config.enableAdRefresh){this.scheduleAdRefresh(event.slot,slotName)}this.collapseEmptySlot(slotName)}else{if(this.retryAttempts){this.retryAttempts.delete(slotName)}if(this.config.callbacks&&this.config.callbacks.onAdLoaded){this.config.callbacks.onAdLoaded.call(this.config,slotName,[event.size[0],event.size[1]])}}}handleSlotOnload(event){const slotName=this.getSlotNameFromEvent(event);this.log(`Slot loaded: ${slotName}`)}handleImpressionViewable(event){const slotName=this.getSlotNameFromEvent(event);this.log(`Impression viewable: ${slotName}`)}collapseEmptySlot(slotName){try{console.log(`üîÑ [GAM] Collapsing empty slot: ${slotName}`);const adUnit=this.config.adUnits.find(unit=>unit.slotName===slotName);if(adUnit&&adUnit.slot){const element=document.getElementById(adUnit.slotName);if(element&&!element.innerHTML.trim()){element.style.display="none"}}}catch(error){console.warn(`‚ö†Ô∏è [GAM] Error collapsing slot ${slotName}:`,error)}}handleRewardedAdGranted(event){console.log("üéâ [GAM] Rewarded ad granted:",event);try{const currentCoins=parseInt(localStorage.getItem("totalcoin")||"0");const rewardAmount=this.config.rewardedAds.rewardAmount||100;const newTotal=currentCoins+rewardAmount;localStorage.setItem("totalcoin",newTotal.toString());const today=(new Date).toDateString();const dailyRewards=JSON.parse(localStorage.getItem("dailyRewards")||"{}");dailyRewards[today]=(dailyRewards[today]||0)+1;localStorage.setItem("dailyRewards",JSON.stringify(dailyRewards));if(typeof showToast==="function"){showToast({title:"Reward Earned!",msg:`üéâ You earned ${rewardAmount} coins!`})}if(this.config.callbacks.onRewardGranted){this.config.callbacks.onRewardGranted.call(this.config,rewardAmount,event)}if(this.config.rewardedAds.autoRedirect){setTimeout(()=>{if(window.location.pathname!=="/playquiz.html"){window.location.href="/playquiz.html"}},2e3)}}catch(error){console.error("‚ùå [GAM] Error handling reward granted:",error)}}handleRewardedAdClosed(event){console.log("üö™ [GAM] Rewarded ad closed:",event);try{if(this.config.callbacks.onRewardedAdClosed){this.config.callbacks.onRewardedAdClosed.call(this.config,event)}}catch(error){console.error("‚ùå [GAM] Error handling rewarded ad closed:",error)}}showRewardedAd(source="unknown"){console.log(`üéÅ [REWARD] showRewardedAd called from: ${source}`);if(!this.config.enableRewardedAds){console.log("‚ùå [REWARD] Rewarded ads disabled in config");if(this.config.callbacks.onRewardFailed){this.config.callbacks.onRewardFailed.call(this.config,"Rewarded ads disabled",false)}return false}const today=(new Date).toDateString();const dailyRewards=JSON.parse(localStorage.getItem("dailyRewards")||"{}");const todayCount=dailyRewards[today]||0;if(todayCount>=this.config.rewardedAds.maxDailyRewards){console.log(`‚ùå [REWARD] Daily limit reached: ${todayCount}/${this.config.rewardedAds.maxDailyRewards}`);if(this.config.callbacks.onRewardFailed){this.config.callbacks.onRewardFailed.call(this.config,"Daily limit reached",false)}return false}return this.createAndShowRewardedSlot()}createAndShowRewardedSlot(){const self=this;if(!window.googletag){console.error("‚ùå [REWARD] googletag not available");return false}console.log("üîß [REWARD] Creating GAM rewarded ad slot...");googletag.cmd.push(function(){try{const slotId=`rewarded-ad-${Date.now()}`;const rewardedSlot=googletag.defineOutOfPageSlot(`/${self.config.networkCode}/Topbestof_Rewarded`,googletag.enums.OutOfPageFormat.REWARDED);if(!rewardedSlot){console.error("‚ùå [REWARD] Failed to create rewarded slot");return false}rewardedSlot.addService(googletag.pubads());rewardedSlot.setTargeting("ad_type","rewarded");rewardedSlot.setTargeting("device",self.isMobile?"mobile":"desktop");self.currentRewardedSlot=rewardedSlot;console.log("‚úÖ [REWARD] Rewarded slot created, displaying...");googletag.display(rewardedSlot);console.log("‚úÖ [REWARD] Rewarded ad display request sent");return true}catch(error){console.error("‚ùå [REWARD] Error creating rewarded slot:",error);if(self.config.callbacks.onRewardFailed){self.config.callbacks.onRewardFailed.call(self.config,"Technical error",true)}return false}});return true}showVignette(source="unknown"){console.log(`üéØ [VIGNETTE] showVignette called from: ${source}`);if(!this.config.enableVignette){console.log("‚ùå [VIGNETTE] Vignette ads disabled");return false}return this.createAndShowInterstitialSlot()}createAndShowInterstitialSlot(){const self=this;if(!window.googletag){console.error("‚ùå [VIGNETTE] googletag not available");return false}console.log("üîß [VIGNETTE] Creating GAM interstitial ad slot...");googletag.cmd.push(function(){try{const interstitialSlot=googletag.defineOutOfPageSlot(`/${self.config.networkCode}/Topbestof_Interstitial`,googletag.enums.OutOfPageFormat.INTERSTITIAL);if(!interstitialSlot){console.error("‚ùå [VIGNETTE] Failed to create interstitial slot");return false}interstitialSlot.addService(googletag.pubads());interstitialSlot.setTargeting("ad_type","interstitial");interstitialSlot.setTargeting("device",self.isMobile?"mobile":"desktop");console.log("‚úÖ [VIGNETTE] Interstitial slot created, displaying...");googletag.display(interstitialSlot);console.log("‚úÖ [VIGNETTE] Interstitial ad display request sent");return true}catch(error){console.error("‚ùå [VIGNETTE] Error creating interstitial slot:",error);return false}});return true}setupRewardedSlotListener(slot){const self=this;try{if(googletag.pubads().addEventListener){googletag.pubads().addEventListener("slotVisibilityChanged",function(event){if(event.slot===slot){console.log("üëÅÔ∏è [GAM] Rewarded slot visibility changed:",event);if(event.inViewPercentage>0){console.log("üé¨ [GAM] Rewarded ad is now visible");setTimeout(()=>{console.log("üéâ [GAM] Simulating rewarded ad completion");self.handleRewardedAdGranted({slot:slot,payload:{amount:self.config.rewardedAds.rewardAmount}})},5e3)}}});googletag.pubads().addEventListener("rewardedSlotGranted",function(event){if(event.slot===slot){console.log("üéÅ [GAM] Official rewarded ad granted event:",event);self.handleRewardedAdGranted(event)}});googletag.pubads().addEventListener("rewardedSlotClosed",function(event){if(event.slot===slot){console.log("üö™ [GAM] Official rewarded ad closed event:",event);self.handleRewardedAdClosed(event)}});googletag.pubads().addEventListener("rewardedSlotReady",function(event){if(event.slot===slot){console.log("üéØ [GAM] Rewarded slot ready event:",event);console.log("‚úÖ [GAM] Rewarded ad is now ready for user interaction")}})}console.log("‚úÖ [GAM] Rewarded slot listener setup complete")}catch(error){console.warn("‚ö†Ô∏è [GAM] Error setting up rewarded slot listener:",error);setTimeout(()=>{console.log("üîÑ [GAM] Fallback: Granting reward immediately");self.handleRewardedAdGranted({slot:slot,payload:{amount:self.config.rewardedAds.rewardAmount}})},2e3)}}getSlotNameFromEvent(event){const adUnitPath=event.slot.getAdUnitPath();const adUnit=this.config.adUnits.find(unit=>unit.adUnitPath===adUnitPath);return adUnit?adUnit.slotName:adUnitPath}scheduleAdRefresh(slot,slotName){if(!this.config.enableAdRefresh)return;setTimeout(()=>{googletag.cmd.push(()=>{googletag.pubads().refresh([slot]);this.log(`Refreshed ad: ${slotName}`)})},this.config.refreshTimeout*1e3)}detectBot(){return this.config.botDetectionRegex.test(navigator.userAgent)}initializeAdvancedBotProtection(){if(!this.config.enableBotProtection)return;this.clickCount=0;this.suspiciousActivity=false;this.lastClickTime=0;document.addEventListener("click",event=>{const now=Date.now();this.clickCount++;if(now-this.lastClickTime<100){this.suspiciousActivity=true}if(this.clickCount>this.config.clickBlockerThreshold&&now-this.sessionStart<1e4){this.handleSuspiciousActivity("rapid_clicking")}this.lastClickTime=now});let mouseMovements=0;document.addEventListener("mousemove",()=>{mouseMovements++});setTimeout(()=>{if(mouseMovements===0&&this.clickCount>0){this.handleSuspiciousActivity("no_mouse_movement")}},5e3);this.log("Advanced bot protection initialized")}handleSuspiciousActivity(reason){this.log(`Suspicious activity detected: ${reason}`);this.suspiciousActivity=true;if(this.config.clickBlockerThreshold>0){this.blockAds(reason)}}blockAds(reason){this.log(`Blocking ads due to: ${reason}`);document.querySelectorAll("[data-slot-name]").forEach(element=>{element.style.display="none"});window.RewardAd=()=>{this.log("Rewarded ad blocked due to suspicious activity");return false}}getSlotNameFromSlot(slot){const adUnitPath=slot.getAdUnitPath();const adUnit=this.config.adUnits.find(unit=>unit.adUnitPath===adUnitPath);return adUnit?adUnit.slotName:adUnitPath}retryFailedAd(slotName,attempt=1){if(attempt>this.config.maxRetry){this.log(`Max retries reached for ${slotName}`);return}setTimeout(()=>{this.log(`Retrying ad load for ${slotName}, attempt ${attempt}`);const slot=this.slots.get(slotName);if(slot){googletag.cmd.push(()=>{googletag.pubads().refresh([slot])})}},this.config.retryTimeGapInMS*attempt)}log(message,category="general"){if(this.config.enableDebugMode||this.config.debug){console.log(`[GAM Manager] ${message}`)}}trackError(error,context,retry=false){this.log(`Error in ${context}: ${error}`,"error");if(this.config.analytics&&this.config.analytics.errorTracking){}}trackPerformanceMetric(metric,value){this.log(`Performance ${metric}: ${value}ms`,"performance");if(this.config.analytics&&this.config.analytics.performanceTracking){}}trackEvent(event,data){this.log(`Event ${event}: ${JSON.stringify(data)}`,"event");if(this.config.analytics&&this.config.analytics.eventTracking){}}refreshAd(slotName){const slot=this.slots.get(slotName);if(slot){googletag.cmd.push(()=>{googletag.pubads().refresh([slot])})}}refreshAllAds(){googletag.cmd.push(()=>{googletag.pubads().refresh()})}updateTargeting(slotName,key,value){const slot=this.slots.get(slotName);if(slot){googletag.cmd.push(()=>{slot.setTargeting(key,value)})}}getPerformanceStats(){const totalTime=performance.now()-this.startTime;const stats={initTime:totalTime,slotsLoaded:this.slots.size,lazySlotsPending:this.lazySlots.size,anchorSlotsActive:this.anchorSlots.length};if(this.config.enableConsoleStats){console.table(stats)}return stats}}if(!window.googletag){const script=document.createElement("script");script.async=true;script.src="https://securepubads.g.doubleclick.net/tag/js/gpt.js";document.head.appendChild(script)}function initializeGAMManager(){window.GAMManagerInstance=new GAMManager(window.GAMManagerConfig);if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",()=>{window.GAMManagerInstance.loadAllAds()})}else{window.GAMManagerInstance.loadAllAds()}}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",initializeGAMManager)}else{initializeGAMManager()}window.GAMManager=GAMManager;window.checkGAMStatus=function(){if(window.GAMManagerInstance){return window.GAMManagerInstance.getPerformanceStats()}return{status:"not initialized"}};window.trackEvent=function(event,data){try{if(window.GAMManagerInstance&&window.GAMManagerInstance.trackEvent){return window.GAMManagerInstance.trackEvent(event,data)}if(window.AdSystemConfig&&window.AdSystemConfig.trackEvent){return window.AdSystemConfig.trackEvent(event,data)}console.log(`[GAM] Event tracked: ${event}`,data)}catch(error){console.warn("trackEvent error:",error)}}})();